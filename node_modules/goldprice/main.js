const cheerio = require('cheerio');
const http = require('superagent');

(async function() {

  let price = await getLiveGoldPricePerOunceInDollars();

  console.log(`The current price of one ounce of gold is $${price}`);

})();

async function getLiveGoldPricePerOunceInDollars() {

  const selector = '.per-ounce';
  const url = 'https://www.apmex.com/spotprices/gold-price';

  let response = await http.get(url);

  let $ = cheerio.load(response.text)

  let body = $(selector);

  let price = parseAmount(body.text());

  return price;
}

function parseAmount(text) {
  text = text.replace('$', '');
  text = text.replace(',', '');

  return parseFloat(text).toFixed(2);
}

module.exports.getLiveGoldPricePerOunceInDollars = getLiveGoldPricePerOunceInDollars;

